### ========================================
### Admin Module Tests
### Canada Immigration Application
### ========================================

### Variables
@baseUrl = http://localhost:3000
@contentType = application/json

# Get admin token from auth.http first
# Run: POST http://localhost:3000/auth/login
@adminToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwic3ViIjoiMDMxMzYwNDYtMWYzNy00OWViLThmYzYtNzk3M2JjNDgyMTQ1Iiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNzYyMDAwNzg3LCJleHAiOjE3NjIwODcxODd9.HNVakok1JffiaJGNy0xBEm6xUaer1aWOmxGhP41UwAA

### ========================================
### Test 1: Get Dashboard Statistics
### Requires authentication
### ========================================
GET {{baseUrl}}/admin/dashboard
Authorization: Bearer {{adminToken}}

### Expected Response:
### {
###   "totalClients": 10,
###   "validatedEquivalence": 3,
###   "validatedResidence": 2,
###   "validatedPartner": 1,
###   "pendingEquivalence": 5,
###   "pendingResidence": 4,
###   "pendingPartner": 3
### }

### ========================================
### Test 2: Get Recent Clients
### Default limit: 10
### ========================================
GET {{baseUrl}}/admin/clients/recent
Authorization: Bearer {{adminToken}}

### Expected: Array of 10 most recent clients

### ========================================
### Test 3: Get Recent Clients with Custom Limit
### ========================================
GET {{baseUrl}}/admin/clients/recent?limit=5
Authorization: Bearer {{adminToken}}

### Expected: Array of 5 most recent clients

### ========================================
### Test 4: Get Pending Validations
### Clients waiting for admin approval
### ========================================
GET {{baseUrl}}/admin/clients/pending
Authorization: Bearer {{adminToken}}

### Expected: Array of non-validated clients

### ========================================
### Test 5: Access Dashboard Without Token
### Should fail with 401
### ========================================
GET {{baseUrl}}/admin/dashboard

### Expected: 401 Unauthorized

### ========================================
### Test 6: Access Dashboard With Invalid Token
### Should fail with 401
### ========================================
GET {{baseUrl}}/admin/dashboard
Authorization: Bearer invalid_token_xyz123

### Expected: 401 Unauthorized

### ========================================
### Test 7: Get Dashboard Stats (Check Performance)
### Run multiple times to check response time
### ========================================
GET {{baseUrl}}/admin/dashboard
Authorization: Bearer {{adminToken}}

### Expected: Response time < 500ms for small dataset

### ========================================
### Test 8: Get Recent Clients with Large Limit
### Test pagination needs
### ========================================
GET {{baseUrl}}/admin/clients/recent?limit=100
Authorization: Bearer {{adminToken}}

### Expected: Array of up to 100 clients
### Note: If database has < 100 clients, returns all

### ========================================
### Success Criteria:
### ✅ Test 1: Returns dashboard statistics
### ✅ Test 2-3: Returns recent clients (different limits)
### ✅ Test 4: Returns pending validations only
### ✅ Tests 5-6: Return 401 Unauthorized
### ✅ Test 7: Response time acceptable
### ✅ Test 8: Large limit handled correctly
### 
### Performance Benchmarks:
### - Dashboard stats: < 500ms
### - Recent clients (10): < 200ms
### - Pending validations: < 500ms
### ========================================
